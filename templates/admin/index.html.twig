{% extends 'base.html.twig' %}

{% block title %}Admin Bundle Demo{% endblock %}

{% block body %}
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
        <h1>Kachnitel\AdminBundle Demo</h1>
        <div>
            <a href="https://github.com/kachnitel/FrdAdminBundle" target="_blank"
               style="display: inline-block; padding: 0.5rem 1rem; background: #24292e; color: white; text-decoration: none; border-radius: 4px; margin-right: 0.5rem;">
                ğŸ“¦ GitHub
            </a>
            <a href="https://github.com/kachnitel/FrdAdminBundle/blob/master/CHANGELOG.md" target="_blank"
               style="display: inline-block; padding: 0.5rem 1rem; background: #6c757d; color: white; text-decoration: none; border-radius: 4px; margin-right: 0.5rem;">
                ğŸ“ Changelog
            </a>
            {% if is_granted('IS_AUTHENTICATED_FULLY') %}
                <a href="{{ path('app_logout') }}"
                   style="display: inline-block; padding: 0.5rem 1rem; background: #dc3545; color: white; text-decoration: none; border-radius: 4px;">
                    ğŸšª Logout
                </a>
            {% else %}
                <a href="{{ path('app_login') }}"
                   style="display: inline-block; padding: 0.5rem 1rem; background: #28a745; color: white; text-decoration: none; border-radius: 4px;">
                    ğŸ”‘ Login
                </a>
            {% endif %}
        </div>
    </div>

    <div style="margin-bottom: 2rem; padding: 1.5rem; background: #f8f9fa; border-left: 4px solid #007bff; border-radius: 4px;">
        <h2 style="margin-top: 0; color: #007bff;">About Kachnitel\AdminBundle</h2>
        <p style="font-size: 1.1rem; line-height: 1.6;">
            A Symfony bundle for rapid admin interface development using <strong>LiveComponents</strong>.
            Build fully functional CRUD interfaces with just PHP attributes - no boilerplate code required.
        </p>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 1rem;">
            <div>
                <strong>ğŸš€ Zero Boilerplate</strong><br>
                <small>Just add <code>#[Admin]</code> to your entities</small>
            </div>
            <div>
                <strong>ğŸ” Built-in Security</strong><br>
                <small>Per-action permission control via attributes</small>
            </div>
            <div>
                <strong>ğŸ¨ Customizable</strong><br>
                <small>Override templates, use custom forms</small>
            </div>
            <div>
                <strong>âš¡ LiveComponents</strong><br>
                <small>Real-time filtering and interactions</small>
            </div>
        </div>
    </div>

    <div style="margin-bottom: 2rem; padding: 1.5rem; background: #e8f5e9; border-left: 4px solid #4caf50; border-radius: 4px;">
        <h2 style="margin-top: 0; color: #2e7d32;">New in v0.2.0</h2>
        <p style="margin-bottom: 1rem;">This demo showcases the latest features introduced in version 0.2.0:</p>

        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem;">
            <div style="background: white; padding: 1rem; border-radius: 4px;">
                <strong>DataSource Abstraction</strong>
                <p style="margin: 0.5rem 0; font-size: 0.9rem;">
                    Display non-Doctrine data sources (APIs, logs, etc.) using the same admin UI
                </p>
                <code style="font-size: 0.8rem;">implements DataSourceInterface</code>
                <br>
                <a href="{{ path('app_admin_datasource_index', {dataSourceId: 'vendor-catalog'}) }}"
                   style="color: #007bff; font-size: 0.85rem;">
                    View Vendor Catalog demo â†’
                </a>
            </div>

            <div style="background: white; padding: 1rem; border-radius: 4px;">
                <strong>DateRangeFilter</strong>
                <p style="margin: 0.5rem 0; font-size: 0.9rem;">
                    Filter by date ranges with from/to pickers
                </p>
                <code style="font-size: 0.8rem;">#[ColumnFilter(type: 'daterange')]</code>
                <br>
                <span style="color: #666; font-size: 0.85rem;">See User's createdAt filter</span>
            </div>

            <div style="background: white; padding: 1rem; border-radius: 4px;">
                <strong>Batch Actions</strong>
                <p style="margin: 0.5rem 0; font-size: 0.9rem;">
                    Multi-select with Shift/Ctrl+Click, bulk delete
                </p>
                <code style="font-size: 0.8rem;">enableBatchActions: true</code>
                <br>
                <span style="color: #666; font-size: 0.85rem;">Enabled on all entities</span>
            </div>

            <div style="background: white; padding: 1rem; border-radius: 4px;">
                <strong>Advanced ColumnFilter</strong>
                <p style="margin: 0.5rem 0; font-size: 0.9rem;">
                    Custom types, placeholders, operators, priority
                </p>
                <code style="font-size: 0.8rem;">#[ColumnFilter(operator: '>=')]</code>
                <br>
                <span style="color: #666; font-size: 0.85rem;">See Part's price filter (Min Price)</span>
            </div>

            <div style="background: white; padding: 1rem; border-radius: 4px;">
                <strong>Pagination & Sorting</strong>
                <p style="margin: 0.5rem 0; font-size: 0.9rem;">
                    Customizable items per page and default sort
                </p>
                <code style="font-size: 0.8rem;">itemsPerPage: 5, sortBy: 'year'</code>
                <br>
                <span style="color: #666; font-size: 0.85rem;">Each entity has different defaults</span>
            </div>

            <div style="background: white; padding: 1rem; border-radius: 4px;">
                <strong>Bundle Dashboard</strong>
                <p style="margin: 0.5rem 0; font-size: 0.9rem;">
                    Built-in dashboard with entity and data source cards
                </p>
                <a href="{{ path('app_admin_dashboard') }}" style="color: #007bff; font-size: 0.85rem;">
                    View Dashboard â†’
                </a>
            </div>
        </div>
    </div>

    <div style="margin-bottom: 2rem; padding: 1.5rem; background: #fff3cd; border-left: 4px solid #ffc107; border-radius: 4px;">
        <h3 style="margin-top: 0; color: #856404;">ğŸ’¡ Quick Start</h3>
        <p>Mark your entity with the <code>#[Admin]</code> attribute:</p>
        <pre style="background: #fff; padding: 1rem; border-radius: 4px; overflow-x: auto;"><code>use Kachnitel\AdminBundle\Attribute\Admin;

#[Admin(
    icon: 'person',
    permissions: [
        'index' => 'ROLE_USER',
        'edit' => 'ROLE_ADMIN',
    ]
)]
class User { ... }</code></pre>
        <p style="margin-bottom: 0;">
            <a href="https://github.com/kachnitel/FrdAdminBundle#usage" target="_blank" style="color: #007bff;">
                ğŸ“– View full documentation â†’
            </a>
        </p>
    </div>

    <div style="margin-bottom: 2rem; padding: 1.5rem; background: #d1ecf1; border-left: 4px solid #0c5460; border-radius: 4px;">
        <h3 style="margin-top: 0; color: #0c5460;">Two Implementation Approaches</h3>
        <p>This demo showcases two ways to use the bundle:</p>
        <ol style="margin-bottom: 0;">
            <li>
                <strong>GenericAdminController</strong> - Zero-code admin using the bundle's built-in routes
                <br><small>â†’ Click "Bundle Admin" in navigation to see it in action</small>
            </li>
            <li>
                <strong>Custom Controller</strong> - Use bundle components in your own controllers
                <br><small>â†’ See examples below</small>
            </li>
        </ol>
    </div>

    <h2>Custom Controller Examples</h2>
    <p style="color: #666; margin-bottom: 1.5rem;">
        These demonstrate using the bundle's components with custom routes and controllers:
    </p>

    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem;">
        {% for entity in entities %}
            <div style="background: white; padding: 1.5rem; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                <h3 style="margin-top: 0; color: #007bff;">{{ entity.name }}s</h3>
                <p style="color: #666; font-size: 0.9rem;">
                    Custom route: <code>/custom-admin/{{ entity.name|lower }}</code>
                </p>
                {% if entity.name == 'User' %}
                    <p style="color: {% if is_granted('IS_AUTHENTICATED_FULLY') %}#28a745{% else %}#dc3545{% endif %}; font-size: 0.85rem; margin-top: 0.5rem;">
                        {% if is_granted('IS_AUTHENTICATED_FULLY') %}
                            Requires <code>ROLE_USER</code>
                        {% else %}
                            ğŸ”’ Requires <code>ROLE_USER</code> (login to access)
                        {% endif %}
                    </p>
                {% else %}
                    <p style="color: #6c757d; font-size: 0.85rem; margin-top: 0.5rem;">
                        No permission required (public)
                    </p>
                {% endif %}
                <a href="{{ path(entity.route, {entity: entity.name|lower}) }}"
                   style="display: inline-block; margin-top: 1rem; padding: 0.5rem 1rem; background: #007bff; color: white; text-decoration: none; border-radius: 4px;">
                    View {{ entity.name }}s
                </a>
            </div>
        {% endfor %}
    </div>

    <div style="margin-top: 3rem; padding: 1.5rem; background: #e7f3ff; border-left: 4px solid #2196F3; border-radius: 4px;">
        <h3 style="margin-top: 0; color: #1976D2;">ğŸ§© Core Components</h3>
        <p>The bundle provides reusable Symfony UX components:</p>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
            <div>
                <strong>EntityList Component</strong><br>
                <small>
                    Live-searchable entity lists with filtering
                    <br><a href="https://github.com/kachnitel/FrdAdminBundle/blob/master/src/Twig/Components/EntityList.php" target="_blank" style="color: #007bff; font-size: 0.85rem;">View code â†’</a>
                </small>
            </div>
        </div>
    </div>

    <div style="margin-top: 2rem; padding: 1.5rem; background: #fff; border: 1px solid #dee2e6; border-radius: 8px;">
        <h3 style="margin-top: 0;">ğŸ¨ Template Override System</h3>
        <p>Customize how any property is rendered by placing templates in your app:</p>
        <pre style="background: #f8f9fa; padding: 1rem; border-radius: 4px; overflow-x: auto; font-size: 0.85rem;"><code>templates/bundles/KachnitelAdminBundle/types/
â”œâ”€â”€ boolean/_preview.html.twig    # Custom boolean rendering
â”œâ”€â”€ User/email/_preview.html.twig  # User-specific email field
â””â”€â”€ _preview.html.twig             # Default fallback</code></pre>
        <p style="margin-bottom: 0;">
            Active overrides in this demo:
        </p>
        {# TODO: Add links to code #}
        <ul style="margin-bottom: 0;">
            <li><strong>Boolean fields</strong> - Colored badges (âœ“ Yes / âœ— No)</li>
            <li><strong>User email</strong> - Clickable mailto link with icon</li>
        </ul>
    </div>

    <div style="margin-top: 2rem; padding: 1.5rem; background: #d4edda; border-left: 4px solid #28a745; border-radius: 4px;">
        <h3 style="margin-top: 0; color: #155724;">ğŸ” Security Features</h3>
        <p>This demo showcases two-level permission control:</p>
        <ul>
            <li><strong>Global setting:</strong> <code>required_role: null</code> disables bundle-wide authentication</li>
            <li><strong>Entity-level:</strong> <code>#[Admin(permissions: ['index' => 'ROLE_USER'])]</code> still enforced</li>
            <li><strong>Custom controller:</strong> Uses <code>AdminEntityVoter</code> to respect entity permissions</li>
        </ul>
        <details style="margin-top: 1rem;">
            <summary style="cursor: pointer; font-weight: bold;">How it works</summary>
            <div style="margin-top: 0.5rem; padding: 1rem; background: #fff; border-radius: 4px;">
                <p style="margin-top: 0;">The bundle's <code>AdminEntityVoter</code> checks permissions in this order:</p>
                <ol style="margin-bottom: 0.5rem;">
                    <li>Entity-specific permission from <code>#[Admin(permissions: [...])]</code></li>
                    <li>Global <code>required_role</code> config (fallback)</li>
                </ol>
                <p style="margin-bottom: 0;">
                    Custom controllers can leverage this via:<br>
                    <code style="font-size: 0.85rem;">$this->denyAccessUnlessGranted(AdminEntityVoter::ADMIN_INDEX, $entityName);</code>
                </p>
            </div>
        </details>
        {% if not is_granted('IS_AUTHENTICATED_FULLY') %}
            <p style="margin-bottom: 0; margin-top: 1rem; padding: 1rem; background: #fff; border-radius: 4px;">
                <strong>Try it:</strong> Login with <code>user@example.com</code> / <code>password</code> to access User entity
            </p>
        {% else %}
            <p style="margin-bottom: 0; margin-top: 1rem; padding: 1rem; background: #fff; border-radius: 4px;">
                <strong>Logged in</strong> - You can now access User entity (requires <code>ROLE_USER</code>)
            </p>
        {% endif %}
    </div>

    <div style="margin-top: 2rem; padding: 1.5rem; background: #e9ecef; border-radius: 8px;">
        <h3>ğŸ“š Documentation & Resources</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
            <a href="https://github.com/kachnitel/FrdAdminBundle" target="_blank"
               style="display: block; padding: 1rem; background: #fff; border-radius: 4px; text-decoration: none; color: #212529; border: 1px solid #dee2e6;">
                <strong style="color: #007bff;">ğŸ“¦ GitHub Repository</strong><br>
                <small>Source code, issues, and PRs</small>
            </a>
            <a href="https://github.com/kachnitel/FrdAdminBundle#readme" target="_blank"
               style="display: block; padding: 1rem; background: #fff; border-radius: 4px; text-decoration: none; color: #212529; border: 1px solid #dee2e6;">
                <strong style="color: #007bff;">ğŸ“– README</strong><br>
                <small>Installation and quick start</small>
            </a>
            <a href="https://github.com/kachnitel/FrdAdminBundle/blob/master/CHANGELOG.md" target="_blank"
               style="display: block; padding: 1rem; background: #fff; border-radius: 4px; text-decoration: none; color: #212529; border: 1px solid #dee2e6;">
                <strong style="color: #007bff;">ğŸ“ Changelog</strong><br>
                <small>Version history and updates</small>
            </a>
            <a href="https://github.com/kachnitel/FrdAdminBundle/blob/master/docs/CONFIGURATION.md" target="_blank"
               style="display: block; padding: 1rem; background: #fff; border-radius: 4px; text-decoration: none; color: #212529; border: 1px solid #dee2e6;">
                <strong style="color: #007bff;">âš™ï¸ Configuration</strong><br>
                <small>Bundle configuration options</small>
            </a>
            <a href="https://symfony.com/bundles/ux-live-component/current/index.html" target="_blank"
               style="display: block; padding: 1rem; background: #fff; border-radius: 4px; text-decoration: none; color: #212529; border: 1px solid #dee2e6;">
                <strong style="color: #007bff;">âš¡ UX LiveComponent Docs</strong><br>
                <small>Learn about LiveComponents</small>
            </a>
            <a href="https://github.com/kachnitel/FrdAdminBundle/tree/master/src/Twig/Components" target="_blank"
               style="display: block; padding: 1rem; background: #fff; border-radius: 4px; text-decoration: none; color: #212529; border: 1px solid #dee2e6;">
                <strong style="color: #007bff;">ğŸ§© Component Source</strong><br>
                <small>Browse component implementations</small>
            </a>
        </div>
    </div>
{% endblock %}
