{% extends 'base.html.twig' %}

{% block title %}Admin Bundle Demo{% endblock %}

{% block body %}
    {# Header with buttons #}
    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-8">
        <h1 class="text-3xl font-bold text-gray-900 dark:text-gray-100">Kachnitel\AdminBundle Demo</h1>
        <div class="flex flex-wrap gap-2">
            <a href="https://github.com/kachnitel/FrdAdminBundle" target="_blank"
               class="inline-flex items-center px-4 py-2 bg-gray-800 dark:bg-gray-700 text-white rounded-md hover:bg-gray-700 dark:hover:bg-gray-600 transition-colors text-sm">
                GitHub
            </a>
            <a href="https://github.com/kachnitel/FrdAdminBundle/blob/master/CHANGELOG.md" target="_blank"
               class="inline-flex items-center px-4 py-2 bg-gray-500 dark:bg-gray-600 text-white rounded-md hover:bg-gray-600 dark:hover:bg-gray-500 transition-colors text-sm">
                Changelog
            </a>
            {% if is_granted('IS_AUTHENTICATED_FULLY') %}
                <a href="{{ path('app_logout') }}"
                   class="inline-flex items-center px-4 py-2 bg-red-600 dark:bg-red-500 text-white rounded-md hover:bg-red-700 dark:hover:bg-red-400 transition-colors text-sm">
                    Logout
                </a>
            {% else %}
                <a href="{{ path('app_login') }}"
                   class="inline-flex items-center px-4 py-2 bg-green-600 dark:bg-green-500 text-white rounded-md hover:bg-green-700 dark:hover:bg-green-400 transition-colors text-sm">
                    Login
                </a>
            {% endif %}
        </div>
    </div>

    {# About section #}
    <div class="mb-8 p-6 bg-gray-50 dark:bg-gray-800 border-l-4 border-blue-500 dark:border-blue-400 rounded-lg">
        <h2 class="text-xl font-bold text-blue-600 dark:text-blue-400 mb-2">About Kachnitel\AdminBundle</h2>
        <p class="text-lg text-gray-700 dark:text-gray-300 leading-relaxed">
            A Symfony bundle for rapid admin interface development using <strong class="text-gray-900 dark:text-white">LiveComponents</strong>.
            Build fully functional CRUD interfaces with just PHP attributes - no boilerplate code required.
        </p>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mt-4">
            <div class="text-gray-700 dark:text-gray-300">
                <strong class="text-gray-900 dark:text-white">Zero Boilerplate</strong><br>
                <span class="text-sm text-gray-600 dark:text-gray-400">Just add <code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">#[Admin]</code> to your entities</span>
            </div>
            <div class="text-gray-700 dark:text-gray-300">
                <strong class="text-gray-900 dark:text-white">Built-in Security</strong><br>
                <span class="text-sm text-gray-600 dark:text-gray-400">Per-action permission control via attributes</span>
            </div>
            <div class="text-gray-700 dark:text-gray-300">
                <strong class="text-gray-900 dark:text-white">Customizable</strong><br>
                <span class="text-sm text-gray-600 dark:text-gray-400">Override templates, use custom forms</span>
            </div>
            <div class="text-gray-700 dark:text-gray-300">
                <strong class="text-gray-900 dark:text-white">LiveComponents</strong><br>
                <span class="text-sm text-gray-600 dark:text-gray-400">Real-time filtering and interactions</span>
            </div>
        </div>
    </div>

    {# Custom Controller Examples #}
    <h2 class="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-2">Custom Controller Examples</h2>
    <p class="text-gray-600 dark:text-gray-400 mb-6">
        These demonstrate using the bundle's components with custom routes and controllers:
    </p>

    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
        {% for entity in entities %}
            <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow dark:shadow-gray-900/50 hover:shadow-lg dark:hover:shadow-gray-900/70 transition-shadow">
                <h3 class="text-xl font-semibold text-blue-600 dark:text-blue-400 mb-2">{{ entity.name }}s</h3>
                <p class="text-gray-600 dark:text-gray-400 text-sm mb-2">
                    Custom route: <code class="bg-gray-100 dark:bg-gray-700 px-1 rounded">/custom-admin/{{ entity.name|lower }}</code>
                </p>
                {% if entity.name == 'User' %}
                    <p class="text-sm mt-2 {{ is_granted('IS_AUTHENTICATED_FULLY') ? 'text-green-600 dark:text-green-400' : 'text-red-600 dark:text-red-400' }}">
                        {% if is_granted('IS_AUTHENTICATED_FULLY') %}
                            Requires <code class="bg-gray-100 dark:bg-gray-700 px-1 rounded">ROLE_USER</code>
                        {% else %}
                            Requires <code class="bg-gray-100 dark:bg-gray-700 px-1 rounded">ROLE_USER</code> (login to access)
                        {% endif %}
                    </p>
                {% else %}
                    <p class="text-sm text-gray-500 dark:text-gray-500 mt-2">
                        No permission required (public)
                    </p>
                {% endif %}
                <a href="{{ path(entity.route, {entity: entity.name|lower}) }}"
                   class="inline-block mt-4 px-4 py-2 bg-blue-600 dark:bg-blue-500 text-white rounded-md hover:bg-blue-700 dark:hover:bg-blue-400 transition-colors text-sm">
                    View {{ entity.name }}s
                </a>
            </div>
        {% endfor %}
    </div>

    {# New in v0.2.0 section #}
    <div class="mb-8 p-6 bg-green-50 dark:bg-green-900/20 border-l-4 border-green-500 dark:border-green-400 rounded-lg">
        <h2 class="text-xl font-bold text-green-700 dark:text-green-400 mb-2">New in v0.2.0</h2>
        <p class="text-gray-700 dark:text-gray-300 mb-4">This demo showcases the latest features introduced in version 0.2.0:</p>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            <div class="bg-white dark:bg-gray-800 p-4 rounded-lg shadow dark:shadow-gray-900/50">
                <strong class="text-gray-900 dark:text-white">DataSource Abstraction</strong>
                <p class="text-sm text-gray-600 dark:text-gray-400 my-2">
                    Display non-Doctrine data sources (APIs, logs, etc.) using the same admin UI
                </p>
                <code class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded text-gray-700 dark:text-gray-300">implements DataSourceInterface</code>
                <br>
                <a href="{{ path('app_admin_datasource_index', {dataSourceId: 'vendor-catalog'}) }}"
                   class="text-blue-600 dark:text-blue-400 hover:underline text-sm mt-2 inline-block">
                    View Vendor Catalog demo &rarr;
                </a>
            </div>

            <div class="bg-white dark:bg-gray-800 p-4 rounded-lg shadow dark:shadow-gray-900/50">
                <strong class="text-gray-900 dark:text-white">DateRangeFilter</strong>
                <p class="text-sm text-gray-600 dark:text-gray-400 my-2">
                    Filter by date ranges with from/to pickers
                </p>
                <code class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded text-gray-700 dark:text-gray-300">#[ColumnFilter(type: 'daterange')]</code>
                <br>
                <span class="text-sm text-gray-500 dark:text-gray-500">See User's createdAt filter</span>
            </div>

            <div class="bg-white dark:bg-gray-800 p-4 rounded-lg shadow dark:shadow-gray-900/50">
                <strong class="text-gray-900 dark:text-white">Batch Actions</strong>
                <p class="text-sm text-gray-600 dark:text-gray-400 my-2">
                    Multi-select with Shift/Ctrl+Click, bulk delete
                </p>
                <code class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded text-gray-700 dark:text-gray-300">enableBatchActions: true</code>
                <br>
                <span class="text-sm text-gray-500 dark:text-gray-500">Enabled on all entities</span>
            </div>

            <div class="bg-white dark:bg-gray-800 p-4 rounded-lg shadow dark:shadow-gray-900/50">
                <strong class="text-gray-900 dark:text-white">Advanced ColumnFilter</strong>
                <p class="text-sm text-gray-600 dark:text-gray-400 my-2">
                    Custom types, placeholders, operators, priority
                </p>
                <code class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded text-gray-700 dark:text-gray-300">#[ColumnFilter(operator: '>=')]</code>
                <br>
                <span class="text-sm text-gray-500 dark:text-gray-500">See Part's price filter (Min Price)</span>
            </div>

            <div class="bg-white dark:bg-gray-800 p-4 rounded-lg shadow dark:shadow-gray-900/50">
                <strong class="text-gray-900 dark:text-white">Pagination & Sorting</strong>
                <p class="text-sm text-gray-600 dark:text-gray-400 my-2">
                    Customizable items per page and default sort
                </p>
                <code class="text-xs bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded text-gray-700 dark:text-gray-300">itemsPerPage: 5, sortBy: 'year'</code>
                <br>
                <span class="text-sm text-gray-500 dark:text-gray-500">Each entity has different defaults</span>
            </div>

            <div class="bg-white dark:bg-gray-800 p-4 rounded-lg shadow dark:shadow-gray-900/50">
                <strong class="text-gray-900 dark:text-white">Bundle Dashboard</strong>
                <p class="text-sm text-gray-600 dark:text-gray-400 my-2">
                    Built-in dashboard with entity and data source cards
                </p>
                <a href="{{ path('app_admin_dashboard') }}" class="text-blue-600 dark:text-blue-400 hover:underline text-sm">
                    View Dashboard &rarr;
                </a>
            </div>
        </div>
    </div>

    {# Quick Start section #}
    <div class="mb-8 p-6 bg-yellow-50 dark:bg-yellow-900/20 border-l-4 border-yellow-500 dark:border-yellow-400 rounded-lg">
        <h3 class="text-lg font-bold text-yellow-700 dark:text-yellow-400 mb-2">Quick Start</h3>
        <p class="text-gray-700 dark:text-gray-300 mb-2">Mark your entity with the <code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">#[Admin]</code> attribute:</p>
        <pre class="bg-white dark:bg-gray-800 p-4 rounded-lg overflow-x-auto text-sm"><code class="text-gray-800 dark:text-gray-200">use Kachnitel\AdminBundle\Attribute\Admin;

#[Admin(
    icon: 'person',
    permissions: [
        'index' => 'ROLE_USER',
        'edit' => 'ROLE_ADMIN',
    ]
)]
class User { ... }</code></pre>
        <p class="mt-3">
            <a href="https://github.com/kachnitel/FrdAdminBundle#usage" target="_blank" class="text-blue-600 dark:text-blue-400 hover:underline">
                View full documentation &rarr;
            </a>
        </p>
    </div>

    {# Two approaches section #}
    <div class="mb-8 p-6 bg-cyan-50 dark:bg-cyan-900/20 border-l-4 border-cyan-600 dark:border-cyan-400 rounded-lg">
        <h3 class="text-lg font-bold text-cyan-700 dark:text-cyan-400 mb-2">Two Implementation Approaches</h3>
        <p class="text-gray-700 dark:text-gray-300 mb-2">This demo showcases two ways to use the bundle:</p>
        <ol class="list-decimal list-inside text-gray-700 dark:text-gray-300 space-y-2">
            <li>
                <strong class="text-gray-900 dark:text-white">GenericAdminController</strong> - Zero-code admin using the bundle's built-in routes
                <br><span class="text-sm text-gray-500 dark:text-gray-400 ml-5">&rarr; Click "Bundle Admin" in navigation to see it in action</span>
            </li>
            <li>
                <strong class="text-gray-900 dark:text-white">Custom Controller</strong> - Use bundle components in your own controllers
                <br><span class="text-sm text-gray-500 dark:text-gray-400 ml-5">&rarr; See examples below</span>
            </li>
        </ol>
    </div>

    {# Core Components section #}
    <div class="mb-8 p-6 bg-blue-50 dark:bg-blue-900/20 border-l-4 border-blue-500 dark:border-blue-400 rounded-lg">
        <h3 class="text-lg font-bold text-blue-700 dark:text-blue-400 mb-2">Core Components</h3>
        <p class="text-gray-700 dark:text-gray-300 mb-4">The bundle provides reusable Symfony UX components:</p>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="text-gray-700 dark:text-gray-300">
                <strong class="text-gray-900 dark:text-white">EntityList Component</strong><br>
                <span class="text-sm text-gray-600 dark:text-gray-400">
                    Live-searchable entity lists with filtering
                    <br><a href="https://github.com/kachnitel/FrdAdminBundle/blob/master/src/Twig/Components/EntityList.php" target="_blank" class="text-blue-600 dark:text-blue-400 hover:underline">View code &rarr;</a>
                </span>
            </div>
        </div>
    </div>

    {# Template Override System section #}
    <div class="mb-8 p-6 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow dark:shadow-gray-900/50">
        <h3 class="text-lg font-bold text-gray-900 dark:text-gray-100 mb-2">Template Override System</h3>
        <p class="text-gray-700 dark:text-gray-300 mb-3">Customize how any property is rendered by placing templates in your app:</p>
        <pre class="bg-gray-100 dark:bg-gray-900 p-4 rounded-lg overflow-x-auto text-sm mb-4"><code class="text-gray-800 dark:text-gray-200">templates/bundles/KachnitelAdminBundle/types/
├── boolean/_preview.html.twig    # Custom boolean rendering
├── User/email/_preview.html.twig  # User-specific email field
└── _preview.html.twig             # Default fallback</code></pre>
        <p class="text-gray-700 dark:text-gray-300 mb-2">
            Active overrides in this demo:
        </p>
        <ul class="list-disc list-inside text-gray-700 dark:text-gray-300 space-y-1">
            <li><strong class="text-gray-900 dark:text-white">Boolean fields</strong> - Colored badges (Yes / No)</li>
            <li><strong class="text-gray-900 dark:text-white">User email</strong> - Clickable mailto link with icon</li>
        </ul>
    </div>

    {# Security Features section #}
    <div class="mb-8 p-6 bg-green-50 dark:bg-green-900/20 border-l-4 border-green-500 dark:border-green-400 rounded-lg">
        <h3 class="text-lg font-bold text-green-700 dark:text-green-400 mb-2">Security Features</h3>
        <p class="text-gray-700 dark:text-gray-300 mb-2">This demo showcases two-level permission control:</p>
        <ul class="list-disc list-inside text-gray-700 dark:text-gray-300 space-y-1 mb-4">
            <li><strong class="text-gray-900 dark:text-white">Global setting:</strong> <code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">required_role: null</code> disables bundle-wide authentication</li>
            <li><strong class="text-gray-900 dark:text-white">Entity-level:</strong> <code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">#[Admin(permissions: ['index' => 'ROLE_USER'])]</code> still enforced</li>
            <li><strong class="text-gray-900 dark:text-white">Custom controller:</strong> Uses <code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">AdminEntityVoter</code> to respect entity permissions</li>
        </ul>
        <details class="mt-4">
            <summary class="cursor-pointer font-semibold text-gray-900 dark:text-white">How it works</summary>
            <div class="mt-3 p-4 bg-white dark:bg-gray-800 rounded-lg">
                <p class="text-gray-700 dark:text-gray-300 mb-2">The bundle's <code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">AdminEntityVoter</code> checks permissions in this order:</p>
                <ol class="list-decimal list-inside text-gray-700 dark:text-gray-300 space-y-1 mb-2">
                    <li>Entity-specific permission from <code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">#[Admin(permissions: [...])]</code></li>
                    <li>Global <code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">required_role</code> config (fallback)</li>
                </ol>
                <p class="text-gray-700 dark:text-gray-300">
                    Custom controllers can leverage this via:<br>
                    <code class="text-sm bg-gray-100 dark:bg-gray-900 px-2 py-1 rounded block mt-1 overflow-x-auto">$this->denyAccessUnlessGranted(AdminEntityVoter::ADMIN_INDEX, $entityName);</code>
                </p>
            </div>
        </details>
        {% if not is_granted('IS_AUTHENTICATED_FULLY') %}
            <p class="mt-4 p-4 bg-white dark:bg-gray-800 rounded-lg text-gray-700 dark:text-gray-300">
                <strong class="text-gray-900 dark:text-white">Try it:</strong> Login with <code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">user@example.com</code> / <code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">password</code> to access User entity
            </p>
        {% else %}
            <p class="mt-4 p-4 bg-white dark:bg-gray-800 rounded-lg text-gray-700 dark:text-gray-300">
                <strong class="text-gray-900 dark:text-white">Logged in</strong> - You can now access User entity (requires <code class="bg-gray-200 dark:bg-gray-700 px-1 rounded">ROLE_USER</code>)
            </p>
        {% endif %}
    </div>

    {# Documentation & Resources section #}
    <div class="mb-8 p-6 bg-gray-100 dark:bg-gray-800 rounded-lg">
        <h3 class="text-lg font-bold text-gray-900 dark:text-gray-100 mb-4">Documentation & Resources</h3>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
            <a href="https://github.com/kachnitel/FrdAdminBundle" target="_blank"
               class="block p-4 bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 hover:shadow-md dark:hover:shadow-gray-900/50 transition-shadow">
                <strong class="text-blue-600 dark:text-blue-400">GitHub Repository</strong><br>
                <span class="text-sm text-gray-600 dark:text-gray-400">Source code, issues, and PRs</span>
            </a>
            <a href="https://github.com/kachnitel/FrdAdminBundle#readme" target="_blank"
               class="block p-4 bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 hover:shadow-md dark:hover:shadow-gray-900/50 transition-shadow">
                <strong class="text-blue-600 dark:text-blue-400">README</strong><br>
                <span class="text-sm text-gray-600 dark:text-gray-400">Installation and quick start</span>
            </a>
            <a href="https://github.com/kachnitel/FrdAdminBundle/blob/master/CHANGELOG.md" target="_blank"
               class="block p-4 bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 hover:shadow-md dark:hover:shadow-gray-900/50 transition-shadow">
                <strong class="text-blue-600 dark:text-blue-400">Changelog</strong><br>
                <span class="text-sm text-gray-600 dark:text-gray-400">Version history and updates</span>
            </a>
            <a href="https://github.com/kachnitel/FrdAdminBundle/blob/master/docs/CONFIGURATION.md" target="_blank"
               class="block p-4 bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 hover:shadow-md dark:hover:shadow-gray-900/50 transition-shadow">
                <strong class="text-blue-600 dark:text-blue-400">Configuration</strong><br>
                <span class="text-sm text-gray-600 dark:text-gray-400">Bundle configuration options</span>
            </a>
            <a href="https://symfony.com/bundles/ux-live-component/current/index.html" target="_blank"
               class="block p-4 bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 hover:shadow-md dark:hover:shadow-gray-900/50 transition-shadow">
                <strong class="text-blue-600 dark:text-blue-400">UX LiveComponent Docs</strong><br>
                <span class="text-sm text-gray-600 dark:text-gray-400">Learn about LiveComponents</span>
            </a>
            <a href="https://github.com/kachnitel/FrdAdminBundle/tree/master/src/Twig/Components" target="_blank"
               class="block p-4 bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 hover:shadow-md dark:hover:shadow-gray-900/50 transition-shadow">
                <strong class="text-blue-600 dark:text-blue-400">Component Source</strong><br>
                <span class="text-sm text-gray-600 dark:text-gray-400">Browse component implementations</span>
            </a>
        </div>
    </div>
{% endblock %}
